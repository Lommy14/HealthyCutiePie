<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <title>‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{
      --bg:#f3f6fb; --card:#fff; --accent:#1f3b70; --muted:#64748b;
    }
    *{box-sizing:border-box;font-family:"Sarabun",system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif}
    body{margin:0;background:var(--bg);padding:20px;display:flex;justify-content:center}
    .container{width:100%;max-width:1150px;background:var(--card);border-radius:12px;padding:20px;box-shadow:0 10px 30px rgba(0,0,0,0.08)}
    h1{margin:0 0 8px;color:var(--accent);font-size:22px}
    p.lead{margin:0 0 12px;color:var(--muted);font-size:13px}
    .flex{display:flex;gap:16px;flex-wrap:wrap}
    .card{background:#f9fbff;border-radius:10px;padding:14px;border:1px solid #e6eefb;flex:1;min-width:280px}
    label{font-size:13px;font-weight:600;color:#0f172a;display:block;margin-bottom:6px}
    select,input,textarea{width:100%;padding:8px;border-radius:8px;border:1px solid #cbd5e1;font-size:14px}
    textarea{min-height:80px;resize:vertical}
    button{background:#2563eb;color:#fff;border:0;padding:8px 12px;border-radius:999px;cursor:pointer;font-weight:600}
    .small{padding:6px 10px;font-size:13px;border-radius:8px}
    .pill{display:inline-block;background:#eef2ff;color:#1d4ed8;padding:6px 10px;border-radius:999px;font-size:13px;margin-right:6px}
    .list{margin:8px 0 0;padding:0;list-style:none}
    .list li{background:#fff;padding:10px;border-radius:8px;margin-bottom:8px;border:1px solid #e6eefb;display:flex;justify-content:space-between;gap:8px;align-items:center}
    .muted{color:var(--muted);font-size:13px}
    .meta{font-size:12px;color:#475569}
    .template{background:#fff;padding:10px;border-radius:8px;border:1px dashed #e6eefb;margin-top:8px}
    .tools{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .danger{background:#ef4444}
    .success{background:#10b981}
    .hide{display:none}
    .summary{background:#f1f5f9;padding:10px;border-radius:8px;margin-top:10px;color:#0f172a}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media(max-width:880px){.grid{grid-template-columns:1fr}}
    .right-col{min-width:320px;max-width:420px}
    .badge{display:inline-block;padding:4px 8px;border-radius:999px;background:#e0edff;color:#1d4ed8;font-size:12px}
    .action-row{display:flex;gap:8px}
  </style>
</head>
<body>
  <div class="container">
    <h1>üß≠ ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h1>
    <p class="lead">‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏ä‡πà‡∏ß‡∏á‡∏≠‡∏≤‡∏¢‡∏∏/‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô ‚Äî ‡∏£‡∏ß‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏¢ ‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£ ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏à‡∏¥‡∏ï ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏ú‡∏• ‡πÅ‡∏ö‡∏ö‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏£‡∏π‡πÅ‡∏•‡∏∞‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£</p>

    <div class="grid">
      <!-- LEFT: settings & library -->
      <div>
        <div class="card">
          <h2 style="margin:0 0 8px">1) ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô / ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</h2>
          <label for="ageGroup">‡∏ä‡πà‡∏ß‡∏á‡∏≠‡∏≤‡∏¢‡∏∏ / ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô</label>
          <select id="ageGroup">
            <option value="primary">‡∏õ.1‚Äì‡∏õ.6 (‡∏õ‡∏£‡∏∞‡∏ñ‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤)</option>
            <option value="lower-sec">‡∏°.1‚Äì‡∏°.3 (‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏ï‡πâ‡∏ô)</option>
            <option value="upper-sec">‡∏°.4‚Äì‡∏°.6 (‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏õ‡∏•‡∏≤‡∏¢)</option>
            <option value="voc">‡∏≠‡∏≤‡∏ä‡∏µ‡∏ß‡∏∞ / ‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤</option>
          </select>
          <div style="margin-top:8px" id="groupInfo" class="muted"></div>
        </div>

        <div class="card" style="margin-top:12px">
          <h2 style="margin:0 0 8px">2) ‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)</h2>
          <p class="muted">‡∏•‡∏≤‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏•‡πâ‡∏ß‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>

          <div style="display:flex;gap:8px;margin-bottom:8px;flex-wrap:wrap">
            <span class="pill">‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£: ‡πÄ‡∏ß‡∏¥‡∏£‡πå‡∏Å‡∏ä‡πá‡∏≠‡∏õ‡∏≠‡πà‡∏≤‡∏ô‡∏â‡∏•‡∏≤‡∏Å</span>
            <span class="pill">‡∏Å‡∏≤‡∏¢: ‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏£‡πá‡∏ß 20 ‡∏ô‡∏≤‡∏ó‡∏µ</span>
            <span class="pill">‡∏à‡∏¥‡∏ï‡πÉ‡∏à: ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏´‡∏≤‡∏¢‡πÉ‡∏à 5-5-5</span>
            <span class="pill">‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï: ‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏°‡∏∑‡πâ‡∏≠‡∏≠‡∏≤‡∏´‡∏≤‡∏£</span>
          </div>

          <label for="activityCategory">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</label>
          <select id="activityCategory">
            <option value="physical">‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß/‡∏Å‡∏µ‡∏¨‡∏≤</option>
            <option value="nutrition">‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£</option>
            <option value="mental">‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏à‡∏¥‡∏ï</option>
            <option value="life-skill">‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï</option>
            <option value="screen">‡∏•‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡∏≠</option>
          </select>

          <label for="activityName" style="margin-top:8px">‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)</label>
          <input id="activityName" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏£‡πá‡∏ß 20 ‡∏ô‡∏≤‡∏ó‡∏µ / ‡πÄ‡∏ß‡∏¥‡∏£‡πå‡∏Å‡∏ä‡πá‡∏≠‡∏õ‡∏™‡∏≠‡∏ô‡∏≠‡πà‡∏≤‡∏ô‡∏â‡∏•‡∏≤‡∏Å">

          <label for="activityDuration" style="margin-top:8px">‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ (‡∏ô‡∏≤‡∏ó‡∏µ)</label>
          <input id="activityDuration" type="number" min="5" value="30">

          <label for="activityObjective" style="margin-top:8px">‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå (‡∏™‡∏±‡πâ‡∏ô ‡πÜ)</label>
          <input id="activityObjective" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£ / ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏î‡∏ó‡∏ô">

          <label for="activityMaterials" style="margin-top:8px">‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå/‡∏ß‡∏±‡∏™‡∏î‡∏∏</label>
          <input id="activityMaterials" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏•‡∏π‡∏Å‡πÄ‡∏ä‡∏∑‡∏≠‡∏Å, ‡πÉ‡∏ö‡∏á‡∏≤‡∏ô, ‡∏õ‡πâ‡∏≤‡∏¢‡∏â‡∏•‡∏≤‡∏Å‡∏≠‡∏≤‡∏´‡∏≤‡∏£">

          <div class="tools">
            <button id="btnAddActivity" class="small">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ</button>
            <button id="btnResetLib" class="small danger">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ó‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</button>
          </div>

          <ul id="activityList" class="list" style="margin-top:10px"></ul>
        </div>

        <div class="card" style="margin-top:12px">
          <h2 style="margin:0 0 8px">3) ‡πÄ‡∏ó‡∏°‡πÄ‡∏û‡∏•‡∏ï‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô / ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h2>
          <p class="muted">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏£‡∏≠‡∏ö‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡πÅ‡∏ú‡∏ô‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏£‡∏π‡∏£‡πà‡∏ß‡∏°</p>
          <div class="template">
            <strong>Objective:</strong>
            <div id="tplObjective" class="meta">[‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£]</div>
            <strong>Materials:</strong>
            <div id="tplMaterials" class="meta">[‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå ‡πÄ‡∏ä‡πà‡∏ô ‡πÉ‡∏ö‡∏á‡∏≤‡∏ô ‡∏õ‡πâ‡∏≤‡∏¢‡∏â‡∏•‡∏≤‡∏Å]</div>
            <strong>Steps:</strong>
            <div id="tplSteps" class="meta">1) ‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠ 10 ‡∏ô‡∏≤‡∏ó‡∏µ 2) ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏° 15 ‡∏ô‡∏≤‡∏ó‡∏µ 3) ‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô 5 ‡∏ô‡∏≤‡∏ó‡∏µ</div>
            <strong>Evaluation:</strong>
            <div id="tplEval" class="meta">‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏Å‡πà‡∏≠‡∏ô/‡∏´‡∏•‡∏±‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°</div>
            <div style="margin-top:8px"><button id="btnCopyTemplate" class="small">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÄ‡∏ó‡∏°‡πÄ‡∏û‡∏•‡∏ï</button></div>
          </div>
        </div>
      </div>

      <!-- RIGHT: planner & summary -->
      <div class="right-col">
        <div class="card">
          <h2 style="margin:0 0 8px">4) ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° (‡πÅ‡∏ú‡∏ô‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå/‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)</h2>

          <label for="planDate">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</label>
          <input id="planDate" type="date">

          <label for="planTime" style="margin-top:8px">‡πÄ‡∏ß‡∏•‡∏≤ (‡πÄ‡∏£‡∏¥‡πà‡∏°)</label>
          <input id="planTime" type="time">

          <label for="planActivity" style="margin-top:8px">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏à‡∏≤‡∏Å‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ</label>
          <select id="planActivity"></select>

          <label for="planTeacher" style="margin-top:8px">‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö / ‡∏Ñ‡∏£‡∏π</label>
          <input id="planTeacher" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡∏£‡∏π‡∏û‡∏•‡∏≠‡∏¢">

          <div class="action-row" style="margin-top:10px">
            <button id="btnAddToPlan" class="small">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÅ‡∏ú‡∏ô</button>
            <button id="btnClearPlan" class="small danger">‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
          </div>

          <ul id="planList" class="list" style="margin-top:10px"></ul>

          <div style="margin-top:8px">
            <button id="btnPrintPlan" class="small">‡∏û‡∏¥‡∏°‡∏û‡πå/‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏ú‡∏ô</button>
            <button id="btnExportJSON" class="small">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î JSON (‡πÅ‡∏ú‡∏ô)</button>
          </div>

          <div class="summary" id="planSummary" style="display:none"></div>
        </div>

        <div class="card" style="margin-top:12px">
          <h2 style="margin:0 0 8px">‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏î‡∏ú‡∏• & ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°</h2>
          <p class="muted">‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏ú‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡∏£‡∏π‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á</p>
          <ul class="muted" style="padding-left:18px;margin:6px 0 0">
            <li>‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏Å‡πà‡∏≠‡∏ô-‡∏´‡∏•‡∏±‡∏á (pre/post test)</li>
            <li>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° (‡πÄ‡∏ä‡πà‡∏ô ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢/‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå)</li>
            <li>‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏° (‡∏Ñ‡∏£‡∏π‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÄ‡∏õ‡πá‡∏ô checklist)</li>
            <li>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å/‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏à‡∏¥‡∏ï (‡∏™‡∏±‡πâ‡∏ô ‡πÜ ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏î‡∏≠‡∏≤‡∏£‡∏µ‡πà 1‚Äì3 ‡∏Ç‡πâ‡∏≠)</li>
            <li>‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏ä‡∏¥‡∏á‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£</li>
          </ul>
          <div style="margin-top:8px">
            <button id="btnAutoSuggestions" class="small success">‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</button>
          </div>
        </div>
      </div>
    </div>

    <div style="margin-top:12px" class="muted">
      ‚ö†Ô∏è ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÅ‡∏•‡∏∞‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏ä‡∏¥‡∏á‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á ‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡πÄ‡∏ä‡∏¥‡∏á‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏î‡πá‡∏Å‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏†‡∏≤‡∏ß‡∏∞‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç
    </div>
  </div>

  <script>
    // ---------- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏ä‡πà‡∏ß‡∏á‡∏≠‡∏≤‡∏¢‡∏∏ ----------
    const ageHints = {
      "primary":"‡πÄ‡∏ô‡πâ‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏ô‡∏∏‡∏Å ‡∏™‡∏±‡πâ‡∏ô ‡πÜ 10-20 ‡∏ô‡∏≤‡∏ó‡∏µ ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏û‡∏Å‡∏°‡∏≤‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô",
      "lower-sec":"‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡πâ‡∏ô‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô ‡∏ù‡∏∂‡∏Å‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏£‡∏π‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏ó‡∏±‡∏ô‡∏™‡∏∑‡πà‡∏≠",
      "upper-sec":"‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏î‡∏π‡πÅ‡∏•‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á ‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏°‡∏∑‡πâ‡∏≠‡∏≠‡∏≤‡∏´‡∏≤‡∏£ ‡πÅ‡∏•‡∏∞‡∏ù‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡πÅ‡∏ö‡∏ö‡∏°‡∏µ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢",
      "voc":"‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏≠‡∏≤‡∏ä‡∏µ‡∏û ‡πÄ‡∏ô‡πâ‡∏ô‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô"
    };
    const ageGroupSelect = document.getElementById('ageGroup');
    const groupInfo = document.getElementById('groupInfo');
    function updateAgeInfo(){ groupInfo.textContent = ageHints[ageGroupSelect.value] || ''; }
    ageGroupSelect.addEventListener('change',updateAgeInfo);
    updateAgeInfo();

    // ---------- ‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° (‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á) ----------
    let library = [
      { id: idGen(), category:'physical', name:'‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏£‡πá‡∏ß 20 ‡∏ô‡∏≤‡∏ó‡∏µ', duration:20, objective:'‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô', materials:'‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡∏Å‡∏µ‡∏¨‡∏≤', evaluation:'‡∏à‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡πâ‡∏≤‡∏ß/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å' },
      { id: idGen(), category:'physical', name:'Circuit ‡∏™‡∏•‡∏±‡∏ö 6 ‡∏ó‡πà‡∏≤ (30 ‡∏ô‡∏≤‡∏ó‡∏µ)', duration:30, objective:'‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏ô‡∏ó‡∏≤‡∏ô', materials:'‡∏û‡∏£‡∏°‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢', evaluation:'count reps/‡∏Ñ‡∏£‡∏π‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï' },
      { id: idGen(), category:'nutrition', name:'‡πÄ‡∏ß‡∏¥‡∏£‡πå‡∏Å‡∏ä‡πá‡∏≠‡∏õ‡∏≠‡πà‡∏≤‡∏ô‡∏â‡∏•‡∏≤‡∏Å‡∏≠‡∏≤‡∏´‡∏≤‡∏£ (45 ‡∏ô‡∏≤‡∏ó‡∏µ)', duration:45, objective:'‡∏£‡∏π‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏ó‡∏±‡∏ô‡∏â‡∏•‡∏≤‡∏Å‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£', materials:'‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏â‡∏•‡∏≤‡∏Å ‡πÉ‡∏ö‡∏á‡∏≤‡∏ô', evaluation:'pre/post quiz' },
      { id: idGen(), category:'mental', name:'‡∏ù‡∏∂‡∏Å‡∏´‡∏≤‡∏¢‡πÉ‡∏à 5-5-5 + ‡∏ï‡∏£‡∏∞‡∏´‡∏ô‡∏±‡∏Å‡∏£‡∏π‡πâ (15 ‡∏ô‡∏≤‡∏ó‡∏µ)', duration:15, objective:'‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', materials:'‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏á‡∏ö', evaluation:'‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î‡∏™‡∏±‡πâ‡∏ô' },
      { id: idGen(), category:'life-skill', name:'‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏°‡∏∑‡πâ‡∏≠‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', duration:40, objective:'‡∏ù‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£', materials:'‡πÉ‡∏ö‡∏á‡∏≤‡∏ô ‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤', evaluation:'‡∏á‡∏≤‡∏ô‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ú‡∏ô' },
      { id: idGen(), category:'screen', name:'‡∏ä‡∏≤‡πÄ‡∏•‡∏ô‡∏à‡πå‡∏•‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡∏≠ 1 ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå', duration:7*24*60, objective:'‡∏•‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡∏≠', materials:'‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°', evaluation:'‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡∏™‡∏£‡∏∏‡∏õ' }
    ];

    // ---------- DOM ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á ----------
    const activityList = document.getElementById('activityList');
    const activityCategory = document.getElementById('activityCategory');
    const activityName = document.getElementById('activityName');
    const activityDuration = document.getElementById('activityDuration');
    const activityObjective = document.getElementById('activityObjective');
    const activityMaterials = document.getElementById('activityMaterials');
    const btnAddActivity = document.getElementById('btnAddActivity');
    const btnResetLib = document.getElementById('btnResetLib');
    const planActivity = document.getElementById('planActivity');

    // ---------- Planner ----------
    const planDate = document.getElementById('planDate');
    const planTime = document.getElementById('planTime');
    const planTeacher = document.getElementById('planTeacher');
    const btnAddToPlan = document.getElementById('btnAddToPlan');
    const planList = document.getElementById('planList');
    const planSummary = document.getElementById('planSummary');
    const btnPrintPlan = document.getElementById('btnPrintPlan');
    const btnExportJSON = document.getElementById('btnExportJSON');
    const btnCopyTemplate = document.getElementById('btnCopyTemplate');
    const tplObjective = document.getElementById('tplObjective');
    const tplMaterials = document.getElementById('tplMaterials');
    const tplSteps = document.getElementById('tplSteps');
    const tplEval = document.getElementById('tplEval');
    const btnAutoSuggestions = document.getElementById('btnAutoSuggestions');
    const btnClearPlan = document.getElementById('btnClearPlan');

    // ---------- Utility ----------
    function idGen(){ return 'id_'+Math.random().toString(36).slice(2,9); }

    // ---------- Render library ----------
    function renderLibrary(){
      activityList.innerHTML = '';
      library.forEach(item=>{
        const li = document.createElement('li');
        li.innerHTML = `<div style="flex:1">
          <div style="font-weight:600">${item.name}</div>
          <div class="meta">${item.category} ‚Ä¢ ${item.duration} ‡∏ô‡∏≤‡∏ó‡∏µ ‚Ä¢ ${item.objective}</div>
        </div>
        <div style="display:flex;gap:6px;align-items:center">
          <button class="small" data-id="${item.id}" onclick="addToPlanFromLib(event)">‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡πÅ‡∏ú‡∏ô</button>
          <button class="small" data-id="${item.id}" onclick="removeFromLib(event)" style="background:#ef4444">‡∏•‡∏ö</button>
        </div>`;
        activityList.appendChild(li);
      });
      // update planActivity select
      renderPlanActivityOptions();
    }

    // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ
    btnAddActivity.addEventListener('click',()=>{
      const name = activityName.value.trim();
      if(!name){ alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°'); return; }
      const item = {
        id: idGen(),
        category: activityCategory.value,
        name,
        duration: Number(activityDuration.value)||30,
        objective: activityObjective.value||'',
        materials: activityMaterials.value||'',
        evaluation: '‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô/‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï'
      };
      library.unshift(item);
      activityName.value=''; activityObjective.value=''; activityMaterials.value=''; activityDuration.value=30;
      renderLibrary();
    });

    // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ó‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
    btnResetLib.addEventListener('click',()=>{
      if(!confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ó‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? ‡∏à‡∏∞‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î')) return;
      // simple reset by reloading page state (or reassign default)
      location.reload();
    });

    window.removeFromLib = function(ev){
      const id = ev.currentTarget.dataset.id;
      library = library.filter(i=>i.id!==id);
      renderLibrary();
    };

    // ---------- Planner data ----------
    let plan = []; // array of {id, activityId, date, time, teacher}

    function renderPlanActivityOptions(){
      planActivity.innerHTML = '';
      library.forEach(it=>{
        const opt = document.createElement('option');
        opt.value = it.id;
        opt.textContent = `${it.name} (${it.duration} ‡∏ô‡∏≤‡∏ó‡∏µ)`;
        planActivity.appendChild(opt);
      });
    }

    // add to plan (from planner form)
    btnAddToPlan.addEventListener('click',()=>{
      const aid = planActivity.value;
      if(!aid){ alert('‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏Å‡πà‡∏≠‡∏ô'); return; }
      const date = planDate.value;
      const time = planTime.value || '09:00';
      const teacher = planTeacher.value || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏';
      const act = library.find(l=>l.id===aid);
      const entry = { id: idGen(), activityId:aid, name:act.name, date, time, teacher, duration:act.duration, category:act.category };
      plan.push(entry);
      renderPlan();
    });

    // add to plan directly from lib button
    window.addToPlanFromLib = function(e){
      const id = e.currentTarget.dataset.id;
      const act = library.find(l=>l.id===id);
      const date = planDate.value || new Date().toISOString().slice(0,10);
      const time = planTime.value || '10:00';
      plan.push({ id:idGen(), activityId: id, name: act.name, date, time, teacher: planTeacher.value||'‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏', duration:act.duration, category:act.category });
      renderPlan();
    };

    // render plan list
    function renderPlan(){
      planList.innerHTML = '';
      if(plan.length===0){
        planList.innerHTML = '<div class="muted" style="padding:8px">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏ú‡∏ô</div>';
        planSummary.style.display='none';
        return;
      }
      // sort by date+time
      plan.sort((a,b)=>{
        const ta = (a.date||'')+' '+(a.time||'');
        const tb = (b.date||'')+' '+(b.time||'');
        return ta.localeCompare(tb);
      });
      plan.forEach(item=>{
        const li = document.createElement('li');
        li.innerHTML = `<div style="flex:1">
          <div style="font-weight:600">${item.name}</div>
          <div class="meta">${item.date||'‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'} ${item.time||''} ‚Ä¢ ${item.duration} ‡∏ô‡∏≤‡∏ó‡∏µ ‚Ä¢ ‡∏Ñ‡∏£‡∏π: ${item.teacher}</div>
        </div>
        <div style="display:flex;gap:6px;align-items:center">
          <button class="small" data-id="${item.id}" onclick="editPlanItem(event)">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
          <button class="small" data-id="${item.id}" onclick="removePlanItem(event)" style="background:#ef4444">‡∏•‡∏ö</button>
        </div>`;
        planList.appendChild(li);
      });
      // update summary
      renderPlanSummary();
    }

    window.removePlanItem = function(e){
      const id = e.currentTarget.dataset.id;
      plan = plan.filter(p=>p.id!==id);
      renderPlan();
    };

    window.editPlanItem = function(e){
      const id = e.currentTarget.dataset.id;
      const item = plan.find(p=>p.id===id);
      if(!item) return;
      // simple inline edit using prompt (keeps code short)
      const newDate = prompt('‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà (YYYY-MM-DD)', item.date||'');
      if(newDate===null) return;
      const newTime = prompt('‡πÄ‡∏ß‡∏•‡∏≤ (HH:MM)', item.time||'09:00');
      if(newTime===null) return;
      const newTeacher = prompt('‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö', item.teacher||'');
      if(newTeacher===null) return;
      item.date = newDate; item.time = newTime; item.teacher = newTeacher;
      renderPlan();
    };

    function renderPlanSummary(){
      if(plan.length===0){ planSummary.style.display='none'; return; }
      planSummary.style.display='block';
      // group by date
      const byDate = {};
      plan.forEach(p=>{
        const d = p.date || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà';
        if(!byDate[d]) byDate[d]=[];
        byDate[d].push(p);
      });
      let html = '<strong>‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏ú‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</strong><br>';
      for(const d of Object.keys(byDate)){
        html += `<div style="margin-top:8px"><em>${d}</em><ul style="padding-left:16px">`;
        byDate[d].forEach(it=>{ html += `<li>${it.time||''} - ${it.name} (${it.duration} ‡∏ô‡∏≤‡∏ó‡∏µ) ‚Ä¢ ‡∏Ñ‡∏£‡∏π: ${it.teacher}</li>`; });
        html += '</ul></div>';
      }
      planSummary.innerHTML = html;
    }

    // print plan (opens print dialog)
    btnPrintPlan.addEventListener('click',()=>{
      // prepare print-friendly view: open new window with summary
      const w = window.open('','_blank','width=900,height=700');
      const title = document.querySelector('h1').textContent;
      w.document.write(`<html><head><title>${title} - ‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏ú‡∏ô</title><meta charset="utf-8"></head><body><h2>${title}</h2>`);
      w.document.write(document.getElementById('planSummary').innerHTML || '<p>‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÅ‡∏ú‡∏ô</p>');
      w.document.write('</body></html>');
      w.document.close();
      w.print();
    });

    // export JSON
    btnExportJSON.addEventListener('click',()=>{
      const payload = { meta:{ageGroup:ageGroupSelect.value, createdAt:new Date().toISOString()}, library, plan };
      const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(payload,null,2));
      const a = document.createElement('a');
      a.href = dataStr;
      a.download = `school_health_plan_${new Date().toISOString().slice(0,10)}.json`;
      document.body.appendChild(a); a.click(); a.remove();
    });

    // populate initial UI
    renderLibrary();

    // copy template into clipboard
    btnCopyTemplate.addEventListener('click',()=>{
      const tpl = `Objective:\n${tplObjective.textContent}\n\nMaterials:\n${tplMaterials.textContent}\n\nSteps:\n${tplSteps.textContent}\n\nEvaluation:\n${tplEval.textContent}`;
      navigator.clipboard?.writeText(tpl).then(()=> alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÄ‡∏ó‡∏°‡πÄ‡∏û‡∏•‡∏ï‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢')) .catch(()=> alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏î‡πâ'));
    });

    // auto suggestions (‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏±‡πâ‡∏ô)
    btnAutoSuggestions.addEventListener('click',()=>{
      if(!confirm('‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á 1 ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå? ‡∏à‡∏∞‡πÄ‡∏ï‡∏¥‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏à‡∏≤‡∏Å‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥')) return;
      // clear plan
      plan = [];
      // choose up to 7 activities (or fewer if library small)
      const picks = library.slice(0,7);
      const today = new Date();
      for(let i=0;i<picks.length;i++){
        const d = new Date(today); d.setDate(today.getDate()+i);
        const dateStr = d.toISOString().slice(0,10);
        plan.push({ id:idGen(), activityId:picks[i].id, name:picks[i].name, date:dateStr, time:'09:00', teacher:'‡∏Ñ‡∏£‡∏π‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ô', duration:picks[i].duration, category:picks[i].category});
      }
      renderPlan();
    });

    // clear plan
    btnClearPlan.addEventListener('click',()=>{
      if(!confirm('‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) return;
      plan = []; renderPlan();
    });

    // initial basic template text (editable in DOM if needed)
    tplObjective.textContent = '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡πÅ‡∏•‡∏∞‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏î‡πâ‡∏≤‡∏ô‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£ ‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥';
    tplMaterials.textContent = '‡πÉ‡∏ö‡∏á‡∏≤‡∏ô ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏â‡∏•‡∏≤‡∏Å‡∏≠‡∏≤‡∏´‡∏≤‡∏£ ‡πÑ‡∏°‡πÇ‡∏Ñ‡∏£‡πÇ‡∏ü‡∏ô (‡∏ñ‡πâ‡∏≤‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô) ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏µ‡∏¨‡∏≤‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô';
    tplSteps.textContent = '1. ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠/‡πÄ‡∏Å‡∏£‡∏¥‡πà‡∏ô 2. ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°/‡∏ó‡∏î‡∏•‡∏≠‡∏á 3. ‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏•‡∏∞‡∏ö‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡πâ‡∏≤‡∏ô 4. ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•‡∏™‡∏±‡πâ‡∏ô ‡πÜ';
    tplEval.textContent = '‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏Å‡πà‡∏≠‡∏ô/‡∏´‡∏•‡∏±‡∏á ‡πÅ‡∏•‡∏∞ checklist ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏° (‡πÄ‡∏ä‡πà‡∏ô ‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢ 3 ‡∏ß‡∏±‡∏ô/‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå)';

    // optional: when library is empty, show placeholder
    if(library.length===0) activityList.innerHTML = '<div class="muted">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏ô‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ</div>';
  </script>
</body>
</html>
